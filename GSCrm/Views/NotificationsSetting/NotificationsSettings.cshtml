@{
    Layout = "_Layout";
}
@using GSCrm.Data
@using GSCrm.Data.ApplicationInfo
@using GSCrm.Models.ViewModels
@using GSCrm.Helpers
@using GSCrm.Data.Cash
@using static GSCrm.CommonConsts
@inject ApplicationDbContext context
@inject ResManager resManager
@inject ICachService cachService
@model AllNotificationsSettingsViewModel
@{
    User currentUser = User.GetUserModel(context);
    string currentUserId = currentUser.Id;
    ViewInfo notView = cachService.GetViewInfo(currentUser.Id, NOTIFICATIONS);
}

@* // Хлебные крошки *@
<nav aria-label="breadcrumb">
    <ol class="breadcrumb">
        <li class="breadcrumb-item"><a asp-controller="Home" asp-action="Index">@resManager.GetString("Home")</a></li>
        <li class="breadcrumb-item">
            <a asp-controller="Root" asp-action="@USER_NOTS" asp-route-pageNumber="@notView.CurrentPageNumber">
                @resManager.GetString(NOTIFICATIONS)
            </a>
        </li>
        <li class="breadcrumb-item active" aria-current="page">@resManager.GetString(NOTS_SETTING)</li>
    </ol>
</nav>

<div id="notSettingsForm">
    <form class="text-center text-md-left" asp-controller="@NOTS_SETTING" asp-action="">
        <input id="defaultOrgNotSettingsUrl" value="@Url.Content($"~/{ORG_NOTS_SETTING}/SetSettingsToDefault")" hidden="hidden" />
        <input id="defaultUserNotSettingsUrl" value="@Url.Content($"~/{USER_NOTS_SETTING}/SetSettingsToDefault")" hidden="hidden" />
        <button id="setNotSettingsToDefault" class="btn btn-outline-dark">@resManager.GetString("SetNotSettingsToDefault")</button>
    </form>

    @* // Вкладки *@
    <ul id="notsTabs" class="nav nav-tabs" role="tablist">
        <li class="nav-item">
            <a class="nav-link" id="userNotSettingsTab" data-toggle="tab" href="#userNotSettingsList" role="tab" aria-controls="userNotSettingsList" aria-selected="false">@resManager.GetString("PrivateNotSettings")</a>
        </li>
        <li class="nav-item">
            <a class="nav-link" id="orgNotSettingsTab" data-toggle="tab" href="#orgNotSettingsList" role="tab" aria-controls="orgNotSettingsList" aria-selected="false">@resManager.GetString("WorkNotSettings")</a>
        </li>
    </ul>

    <div class="tab-content mt-3">
        @* // Настройки уведомлений для пользователя *@
        @{ await Html.RenderPartialAsync($"{NOT_SETTING_VIEWS_REL_PATH}Partial/UserNotificationsSettings.cshtml"); }

        @* // Настройки уведомлений для Организаций  *@
        @{ await Html.RenderPartialAsync($"{NOT_SETTING_VIEWS_REL_PATH}Partial/OrgNotificationsSettings.cshtml"); }
    </div>

    @*Моделньое окно настроек уведомления*@
    <div id="notSettingOptionsModal" class="d-none" data-notSettingId>
        <p class="label-sm">@resManager.GetString("SendNotsThrow")</p>
        <div class="row justify-content-around">
            <div id="InboxOption" class="col not-target">
                <input class="m-0" type="radio" name="notSettingTargetTab" value="Inbox" />
                <label class="label-non-select" for="Inbox">@resManager.GetString("Inbox")</label>
            </div>
            <div id="EmailOption" class="col not-target">
                <input class="m-0" type="radio" name="notSettingTargetTab" value="Email" />
                <label class="label-non-select" for="Email">@resManager.GetString("Email")</label>
            </div>
        </div>
    </div>

    @*Действия, которые можно выполнить с уведомлениями*@
    <form id="notSettingsActions" class="mt-3">
        <input id="commitOrgNotSettingsUrl" value="@Url.Content($"~/{ORG_NOTS_SETTING}/CommitSettings")" hidden="hidden" />
        <input id="commitUserNotSettingsUrl" value="@Url.Content($"~/{USER_NOTS_SETTING}/CommitSettings")" hidden="hidden" />
        <div class="row justify-content-around mt-1 mb-3">
            <div class="col-xl text-center">
                <button type="submit" class="update-not-setting btn btn-outline-dark">@resManager.GetString("CommitChanges")</button>
            </div>
            <div class="col-xl text-center mt-3 mt-xl-0">
                <button class="cancel-update-not-setting btn btn-outline-danger">@resManager.GetString("CancelLabel")</button>
            </div>
        </div>
    </form>
</div>